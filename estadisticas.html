    // ====================================================================
    // COMPONENTE: ChartBox
    // ====================================================================
    const ChartBox = ({ type, data, title, id, horizontal = false, shortenLabels = false, minHeight = "350px", isHistory = false, customColors = null }) => {
        const chartRef = React.useRef(null);
        const canvasRef = React.useRef(null);
        const [menuOpen, setMenuOpen] = React.useState(false);
        const menuRef = React.useRef(null);

        React.useEffect(() => {
            const handleClickOutside = (event) => {
                if (menuRef.current && !menuRef.current.contains(event.target)) {
                    setMenuOpen(false);
                }
            };
            document.addEventListener("mousedown", handleClickOutside);
            return () => {
                document.removeEventListener("mousedown", handleClickOutside);
            };
        }, []);

        React.useEffect(() => {
            if (!canvasRef.current || !data) return;
            if (typeof window.Chart === 'undefined') return;
            
            if (chartRef.current) chartRef.current.destroy();

            const ctx = canvasRef.current.getContext('2d');
            const isPie = type === 'pie' || type === 'doughnut';
            
            // Preparar datos
            let chartDataConfig = {};

            if (isHistory) {
                // Modo historial: 'data' ya viene preparada desde el componente padre
                chartDataConfig = data;
            } else {
                // Modo est√°ndar: 'data' es un objeto clave-valor simple
                const rawLabels = Object.keys(data);
                const displayLabels = rawLabels.map(l => shortenLabels ? shortenLabel(l) : l);
                
                // Determinaci√≥n de colores
                const bgColors = customColors || (isPie ? INSTITUTIONAL_COLORS : VIBRANT_COLORS);
                const borderColors = isPie ? '#ffffff' : (customColors || VIBRANT_COLORS);

                chartDataConfig = {
                    labels: displayLabels,
                    datasets: [{ 
                        label: title.replace(/[üìöüë•üè¢üìãüìàüè´üë®‚Äçüè´]/g, '').trim(), 
                        data: Object.values(data), 
                        backgroundColor: bgColors,
                        borderColor: borderColors,
                        borderWidth: isPie ? 2 : 1,
                        borderRadius: isPie ? 0 : 6,
                        barPercentage: 0.6,
                        maxBarThickness: 50
                    }]
                };
            }

            const totalValues = isPie ? chartDataConfig.datasets[0].data.reduce((acc, curr) => acc + (typeof curr === 'number' ? curr : 0), 0) : 0;

            let config = {
                type: type,
                data: chartDataConfig,
                plugins: window.ChartDataLabels ? [window.ChartDataLabels] : [],
                options: {
                    responsive: true, 
                    maintainAspectRatio: false,
                    indexAxis: horizontal ? 'y' : 'x',
                    animation: { duration: 600, easing: 'easeOutQuart' },
                    scales: isPie ? {} : { 
                        y: { 
                            beginAtZero: true, 
                            ticks: { 
                                color: '#374151',
                                font: { size: 11, weight: '600' },
                                autoSkip: false,
                                callback: function(value) { 
                                    if (this.getLabelForValue && !isHistory && horizontal) {
                                        return this.getLabelForValue(value);
                                    }
                                    if (value % 1 === 0) return value; 
                                } 
                            },
                            grid: { color: '#e5e7eb', borderDash: [5, 5], display: !horizontal }
                        },
                        x: {
                            beginAtZero: true, 
                            ticks: { 
                                color: '#374151',
                                font: { size: 11, weight: '600' }
                            },
                            grid: { display: false }
                        }
                    },
                    plugins: { 
                        datalabels: {
                            display: true, 
                            align: isHistory ? 'top' : (horizontal ? 'end' : 'top'),
                            anchor: isHistory ? 'center' : (horizontal ? 'end' : 'end'),
                            backgroundColor: isHistory ? 'white' : (isPie ? 'rgba(0,0,0,0.6)' : 'transparent'),
                            borderRadius: 4,
                            color: isHistory ? '#1B396A' : (isPie ? '#fff' : '#374151'),
                            font: { weight: 'bold', size: 10 },
                            padding: 2,
                            formatter: (value) => {
                                if (isHistory) return value > 0 ? value : '';
                                if (totalValues > 0) {
                                    const percentage = ((value / totalValues) * 100).toFixed(1);
                                    if(percentage < 3 && !horizontal) return value;
                                    return `${value} (${percentage}%)`;
                                }
                                return value;
                            },
                            offset: 4,
                            clip: false
                        },
                        legend: { 
                            display: isPie || isHistory, 
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                boxWidth: 8
                            }
                        }
                    },
                    layout: { padding: { top: 25, right: 20, left: 10, bottom: 10 } }
                }
            };

            if (!isPie && horizontal) {
                config.options.scales.x.display = false;
            }
            if (isPie) config.options.layout.padding = 20;

            chartRef.current = new window.Chart(ctx, config);
            return () => { if (chartRef.current) chartRef.current.destroy(); };
        }, [data, type, title, horizontal, id, shortenLabels, isHistory, customColors]);

        const downloadSingleChart = (format) => {
            setMenuOpen(false);
            // Peque√±o delay para que se cierre el men√∫ antes de capturar
            setTimeout(async () => {
                const element = document.getElementById(`chartBox-${id}`);
                if (!element) return;

                try {
                    // Escala 3 para mayor calidad
                    const canvas = await html2canvas(element, { 
                        scale: 3, 
                        useCORS: true, 
                        backgroundColor: '#ffffff',
                        ignoreElements: (el) => el.id === `menu-btn-${id}` // Ignorar el bot√≥n del men√∫
                    });

                    // Cargar Logo
                    const logoData = await getImageDataFromURL(ITD_LOGO_URL);
                    const cleanTitle = title.replace(/[üìöüë•üè¢üìãüìàüè´üë®‚Äçüè´]/g, '').trim();

                    if (format === 'png') {
                        // Crear Canvas Compuesto para PNG
                        const finalCanvas = document.createElement('canvas');
                        const ctx = finalCanvas.getContext('2d');
                        
                        const headerHeight = 180; // Aumentado para dar espacio
                        const margin = 40;
                        finalCanvas.width = canvas.width;
                        finalCanvas.height = canvas.height + headerHeight;

                        // Fondo Blanco
                        ctx.fillStyle = '#ffffff';
                        ctx.fillRect(0, 0, finalCanvas.width, finalCanvas.height);

                        // 1. Logo (Calculado por altura para no chocar con la l√≠nea)
                        if (logoData) {
                            const img = new Image();
                            img.src = logoData;
                            await new Promise(r => img.onload = r);
                            
                            const maxLogoHeight = 120; // Altura m√°xima permitida
                            const ratio = img.width / img.height;
                            const logoW = maxLogoHeight * ratio;
                            const logoH = maxLogoHeight;
                            
                            ctx.drawImage(img, margin, 20, logoW, logoH);
                        }

                        // 2. T√≠tulos
                        ctx.fillStyle = BLUE_COLOR;
                        ctx.font = 'bold 42px Helvetica, Arial, sans-serif';
                        ctx.textAlign = 'center';
                        ctx.fillText('INSTITUTO TECNOL√ìGICO DE DURANGO', finalCanvas.width / 2, 80);
                        
                        ctx.fillStyle = '#666';
                        ctx.font = '30px Helvetica, Arial, sans-serif';
                        ctx.fillText(cleanTitle, finalCanvas.width / 2, 130);

                        // 3. L√≠nea Guinda (Posicionada debajo de todo)
                        ctx.strokeStyle = GUINDA_COLOR;
                        ctx.lineWidth = 6;
                        ctx.beginPath();
                        ctx.moveTo(margin, 165); // Bajada a 165px
                        ctx.lineTo(finalCanvas.width - margin, 165);
                        ctx.stroke();

                        // 4. Gr√°fica
                        ctx.drawImage(canvas, 0, headerHeight);

                        const link = document.createElement('a');
                        link.download = `${cleanTitle.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.png`;
                        link.href = finalCanvas.toDataURL('image/png');
                        link.click();

                    } else if (format === 'pdf') {
                        const { jsPDF } = window.jspdf;
                        
                        const orientation = canvas.width > canvas.height ? 'landscape' : 'portrait';
                        const pdf = new jsPDF(orientation, 'mm', 'letter');
                        
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        const pdfHeight = pdf.internal.pageSize.getHeight();
                        const margin = 10;

                        // --- 1. Encabezado Institucional (Sin recuadro azul) ---
                        // Logo (Proporcional)
                        if (logoData) {
                            const imgProps = pdf.getImageProperties(logoData);
                            const logoWidth = 22; // Ancho fijo en mm
                            const logoHeight = (imgProps.height * logoWidth) / imgProps.width; // Altura calculada
                            pdf.addImage(logoData, 'PNG', margin, 5, logoWidth, logoHeight); 
                        }
                        
                        // Textos
                        pdf.setFontSize(14);
                        pdf.setFont('helvetica', 'bold');
                        pdf.setTextColor(27, 57, 106); // Azul #1B396A
                        pdf.text('INSTITUTO TECNOL√ìGICO DE DURANGO', pdfWidth / 2, 12, { align: 'center' });
                        
                        pdf.setFontSize(10);
                        pdf.setFont('helvetica', 'normal');
                        pdf.setTextColor(80);
                        pdf.text('Coordinaci√≥n de Actualizaci√≥n Docente', pdfWidth / 2, 18, { align: 'center' });

                        // L√≠nea Guinda
                        pdf.setDrawColor(157, 36, 73); // #9D2449
                        pdf.setLineWidth(1);
                        pdf.line(margin, 28, pdfWidth - margin, 28); // Bajada ligeramente

                        // --- 2. T√≠tulo de la Gr√°fica ---
                        pdf.setFontSize(12);
                        pdf.setTextColor(27, 57, 106);
                        pdf.setFont('helvetica', 'bold');
                        pdf.text(cleanTitle, pdfWidth / 2, 38, { align: 'center' });

                        // --- 3. Imagen de la Gr√°fica ---
                        const imgData = canvas.toDataURL('image/png');
                        const imgProps = pdf.getImageProperties(imgData);
                        const ratio = imgProps.width / imgProps.height;
                        
                        const availWidth = pdfWidth - (margin * 2);
                        const availHeight = pdfHeight - 45 - 15 - 10 - (margin * 2);
                        
                        let finalW = availWidth;
                        let finalH = finalW / ratio;
                        
                        if (finalH > availHeight) {
                            finalH = availHeight;
                            finalW = finalH * ratio;
                        }
                        
                        const x = (pdfWidth - finalW) / 2;
                        const y = 45 + ((availHeight - finalH) / 2); 

                        pdf.addImage(imgData, 'PNG', x, y, finalW, finalH);

                        // --- 4. Pie de P√°gina ---
                        pdf.setDrawColor(157, 36, 73); 
                        pdf.line(margin, pdfHeight - 12, pdfWidth - margin, pdfHeight - 12);
                        
                        pdf.setFontSize(8);
                        pdf.setTextColor(100);
                        const dateStr = new Date().toLocaleDateString('es-MX', { year: 'numeric', month: 'long', day: 'numeric' });
                        pdf.text(`Generado: ${dateStr}`, margin, pdfHeight - 7);
                        pdf.text('ITD - Estad√≠stica Oficial', pdfWidth - margin, pdfHeight - 7, { align: 'right' });

                        pdf.save(`${cleanTitle.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.pdf`);
                    }
                } catch (err) {
                    console.error("Error descargando gr√°fica", err);
                    alert("Error al generar la descarga.");
                }
            }, 100);
        };

        return (
            <div id={`chartBox-${id}`} className="bg-white p-5 rounded-xl shadow-md h-full flex flex-col border border-gray-100 transition-all hover:shadow-lg relative" style={{ minHeight }}>
                <div className="flex justify-between items-center border-b border-gray-100 pb-3 mb-4">
                    <div className="w-8"></div> 
                    <h3 className="text-gray-700 font-bold text-center text-base flex items-center justify-center gap-2 flex-grow">
                        {title}
                    </h3>
                    <div className="relative" ref={menuRef}>
                        <button 
                            id={`menu-btn-${id}`}
                            onClick={() => setMenuOpen(!menuOpen)}
                            className="text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 focus:outline-none transition-colors"
                            title="Opciones de descarga"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg>
                        </button>
                        {menuOpen && (
                            <div className="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-xl z-50 border border-gray-200 animate-fadeIn">
                                <div className="py-1">
                                    <button 
                                        onClick={() => downloadSingleChart('png')}
                                        className="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-[#1B396A]"
                                    >
                                        <span className="mr-2">üñºÔ∏è</span> Descargar PNG
                                    </button>
                                    <button 
                                        onClick={() => downloadSingleChart('pdf')}
                                        className="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-[#1B396A]"
                                    >
                                        <span className="mr-2">üìÑ</span> Descargar PDF
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
                <div className="flex-1 relative w-full h-full" style={{ minHeight: '200px' }}><canvas ref={canvasRef} id={id}></canvas></div>
            </div>
        );
    };

    // ====================================================================
    // COMPONENTE: Dashboard (L√≥gica principal)
    // ====================================================================
    const Dashboard = ({ user, onLogout }) => {
        const [statsData, setStatsData] = React.useState(null);
        const [loading, setLoading] = React.useState(true);
        const [generatingPDF, setGeneratingPDF] = React.useState(false);
        const [period, setPeriod] = React.useState("ACTUAL");
        const [availableYears, setAvailableYears] = React.useState([]);

        React.useEffect(() => {
            fetchData();
        }, [period]);

        const fetchData = async () => {
            setLoading(true);
            try {
                const response = await fetch(`${CONFIG.APPS_SCRIPT_URL}?action=getStatisticsData&period=${period}`);
                const result = await response.json();
                if (result.success) {
                    setStatsData(result.data);
                    if(result.availableYears) setAvailableYears(result.availableYears);
                } else {
                    alert("Error obteniendo datos: " + result.message);
                }
            } catch (error) {
                console.error("Error:", error);
            } finally {
                setLoading(false);
            }
        };

        const generatePDF = async () => {
            setGeneratingPDF(true);
            await new Promise(resolve => setTimeout(resolve, 500)); 

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'letter'); 
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = pdf.internal.pageSize.getHeight();
            const margin = 10;
            const contentWidth = pdfWidth - (margin * 2);

            const captureElement = async (elementId) => {
                const element = document.getElementById(elementId);
                if (!element) return null;
                const canvas = await html2canvas(element, { scale: 2, useCORS: true, backgroundColor: '#ffffff' });
                return canvas.toDataURL('image/png');
            };

            const addHeader = async (doc) => {
                const logo = await getImageDataFromURL(ITD_LOGO_URL);
                doc.setFillColor(27, 57, 106); 
                doc.rect(0, 0, pdfWidth, 20, 'F');
                if (logo) {
                    doc.addImage(logo, 'PNG', margin, 2, 16, 16);
                }
                doc.setFontSize(12);
                doc.setFont("helvetica", "bold");
                doc.setTextColor(255, 255, 255);
                doc.text("INSTITUTO TECNOL√ìGICO DE DURANGO", pdfWidth / 2, 10, { align: "center" });
                doc.setFontSize(9);
                doc.setFont("helvetica", "normal");
                doc.text("Reporte Estad√≠stico de Actualizaci√≥n Docente", pdfWidth / 2, 16, { align: "center" });
            };

            const addFooter = (doc, pageNum) => {
                doc.setFillColor(157, 36, 73); 
                doc.rect(0, pdfHeight - 12, pdfWidth, 12, 'F');
                doc.setFontSize(8);
                doc.setTextColor(255, 255, 255);
                const date = new Date().toLocaleDateString();
                doc.text(`Generado: ${date} | P√°gina ${pageNum}`, margin, pdfHeight - 5);
                doc.text("Coordinaci√≥n de Actualizaci√≥n Docente", pdfWidth - margin, pdfHeight - 5, { align: "right" });
            };

            // P√°gina 1: KPIs y Top Cursos/Deptos
            await addHeader(pdf);
            const kpiImg = await captureElement('kpi-section');
            if (kpiImg) {
                pdf.addImage(kpiImg, 'PNG', margin, 25, contentWidth, 30);
            }
            const chart1Img = await captureElement('chartBox-topCursos');
            if (chart1Img) {
                pdf.addImage(chart1Img, 'PNG', margin, 60, contentWidth, 100);
            }
            const chart2Img = await captureElement('chartBox-topDeptos');
            if (chart2Img) {
                pdf.addImage(chart2Img, 'PNG', margin, 170, contentWidth, 90);
            }
            addFooter(pdf, 1);

            // P√°gina 2: Demograf√≠a y Tipos
            pdf.addPage();
            await addHeader(pdf);
            const chart3Img = await captureElement('chartBox-genero');
            if (chart3Img) {
                pdf.addImage(chart3Img, 'PNG', margin, 25, contentWidth / 2 - 5, 80);
            }
            const chart4Img = await captureElement('chartBox-tipo');
            if (chart4Img) {
                pdf.addImage(chart4Img, 'PNG', pdfWidth / 2 + 5, 25, contentWidth / 2 - 5, 80);
            }
            const chart5Img = await captureElement('chartBox-frecuencia');
            if (chart5Img) {
                pdf.addImage(chart5Img, 'PNG', margin, 115, contentWidth, 90);
            }
            addFooter(pdf, 2);

            // P√°gina 3: Hist√≥rico y Docentes
            pdf.addPage();
            await addHeader(pdf);
            const chart6Img = await captureElement('chartBox-historico');
            if (chart6Img) {
                pdf.addImage(chart6Img, 'PNG', margin, 25, contentWidth, 100);
            }
            const chart7Img = await captureElement('chartBox-docentesYear');
            if (chart7Img) {
                pdf.addImage(chart7Img, 'PNG', margin, 135, contentWidth, 100);
            }
            addFooter(pdf, 3);

            pdf.save(`Reporte_Estadistico_${period}.pdf`);
            setGeneratingPDF(false);
        };

        const generateCourseEvolutionData = () => {
            if (!statsData || !statsData.periodTrend || !statsData.historicalTrend) return { labels: [], datasets: [] };
            
            const pTrend = statsData.periodTrend;
            const hTrend = statsData.historicalTrend;
            
            // Ordenar a√±os descendente para visualizaci√≥n l√≥gica cronol√≥gica en el eje X
            const sortedYears = Object.keys(hTrend).sort();
            
            const labels = [];
            const dataValues = [];
            const bgColors = [];

            sortedYears.forEach(year => {
                const total = hTrend[year]?.cursos || 0;
                const ene = pTrend[`${year}-Enero`]?.cursos || 0;
                const jun = pTrend[`${year}-Junio`]?.cursos || 0;
                const ago = pTrend[`${year}-Agosto`]?.cursos || 0;

                // Orden Solicitado: Total -> Ene -> Jun -> Ago
                labels.push(`Total '${year.substring(2)}`, 'Ene', 'Jun', 'Ago');
                dataValues.push(total, ene, jun, ago);
                
                // Colores espec√≠ficos
                bgColors.push('#1e3a8a'); // Navy para Total
                bgColors.push('#f472b6'); // Pink para Ene
                bgColors.push('#3b82f6'); // Blue para Jun
                bgColors.push('#fbbf24'); // Yellow para Ago
            });

            return {
                labels: labels,
                datasets: [{
                    label: 'Cursos Ofertados',
                    data: dataValues,
                    backgroundColor: bgColors,
                    borderRadius: 4,
                    barPercentage: 0.6,
                    categoryPercentage: 0.8
                }]
            };
        };

        const generateTeacherEvolutionData = () => {
            if (!statsData || !statsData.historicalTrend) return { labels: [], datasets: [] };
            
            const years = Object.keys(statsData.historicalTrend).sort();
            // Colores vibrantes para cada a√±o
            const colors = ['#4f46e5', '#06b6d4', '#8b5cf6', '#ec4899', '#f59e0b', '#10b981']; 
            
            return {
                labels: years,
                datasets: [{
                    label: 'Total Docentes',
                    data: years.map(y => statsData.historicalTrend[y].registros),
                    backgroundColor: years.map((_, i) => colors[i % colors.length]),
                    borderRadius: 6,
                    barPercentage: 0.5,
                    maxBarThickness: 50
                }]
            };
        };

        if (loading) {
            return (
                <div className="flex justify-center items-center h-full">
                    <div className="animate-spin h-12 w-12 border-4 border-[#1B396A] rounded-full border-t-transparent"></div>
                </div>
            );
        }

        return (
            <div className="p-6 max-w-7xl mx-auto animate-fadeIn relative">
                {/* Modal de Generando PDF */}
                {generatingPDF && (
                    <div className="pdf-overlay">
                        <div className="pdf-modal">
                            <div className="pdf-spinner"></div>
                            <h3 className="text-xl font-bold text-gray-800 mb-2">Generando Reporte PDF</h3>
                            <p className="text-gray-500">Por favor espere, procesando gr√°ficas...</p>
                        </div>
                    </div>
                )}

                {/* Encabezado del Dashboard */}
                <div className="flex flex-col md:flex-row justify-between items-center mb-8 gap-4 bg-white p-6 rounded-xl shadow-md border-l-4 border-[#1B396A]">
                    <div>
                        <h2 className="text-2xl md:text-3xl font-bold text-gray-800">
                            Dashboard Estrat√©gico
                        </h2>
                        <p className="text-gray-500 mt-1">
                            An√°lisis de datos de actualizaci√≥n docente. Usuario: <span className="font-semibold text-[#1B396A]">{user.name}</span>
                        </p>
                    </div>
                    <div className="flex gap-3">
                        <div className="relative">
                            <select 
                                value={period} 
                                onChange={(e) => setPeriod(e.target.value)}
                                className="appearance-none bg-gray-50 border border-gray-300 text-gray-700 py-2 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:bg-white focus:border-[#1B396A] font-bold cursor-pointer hover:bg-gray-100 transition-colors shadow-sm"
                            >
                                <option value="ACTUAL">üü¢ Periodo Actual</option>
                                {availableYears.map(y => <option key={y} value={y}>üìÖ A√±o {y}</option>)}
                            </select>
                            <div className="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                                <svg className="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                            </div>
                        </div>
                        <button onClick={generatePDF} className="bg-[#9D2449] hover:bg-[#801d3a] text-white font-bold py-2 px-6 rounded-lg shadow transition-all transform hover:scale-105 flex items-center gap-2">
                            <span>üìÑ</span> PDF
                        </button>
                        <button onClick={onLogout} className="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg transition-colors">
                            Salir
                        </button>
                    </div>
                </div>

                {/* KPIs */}
                <div id="kpi-section" className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div className="bg-white p-6 rounded-xl shadow-md border-b-4 border-blue-600 flex items-center justify-between">
                        <div>
                            <p className="text-gray-500 text-xs font-bold uppercase tracking-wider">Total Inscripciones</p>
                            <p className="text-3xl font-bold text-gray-800 mt-1">{statsData.totalInscripciones}</p>
                        </div>
                        <div className="text-3xl bg-blue-100 p-3 rounded-full text-blue-600">üìù</div>
                    </div>
                    <div className="bg-white p-6 rounded-xl shadow-md border-b-4 border-green-500 flex items-center justify-between">
                        <div>
                            <p className="text-gray-500 text-xs font-bold uppercase tracking-wider">Docentes √önicos</p>
                            <p className="text-3xl font-bold text-gray-800 mt-1">{statsData.coberturaDocente.actualizados}</p>
                        </div>
                        <div className="text-3xl bg-green-100 p-3 rounded-full text-green-600">üë•</div>
                    </div>
                    <div className="bg-white p-6 rounded-xl shadow-md border-b-4 border-purple-500 flex items-center justify-between">
                        <div>
                            <p className="text-gray-500 text-xs font-bold uppercase tracking-wider">Cursos Activos</p>
                            <p className="text-3xl font-bold text-gray-800 mt-1">{statsData.topCursos.length}</p>
                        </div>
                        <div className="text-3xl bg-purple-100 p-3 rounded-full text-purple-600">üìö</div>
                    </div>
                    <div className="bg-white p-6 rounded-xl shadow-md border-b-4 border-yellow-500 flex items-center justify-between">
                        <div>
                            <p className="text-gray-500 text-xs font-bold uppercase tracking-wider">Cobertura Plantilla</p>
                            <p className="text-3xl font-bold text-gray-800 mt-1">{statsData.coberturaDocente.porcentaje}%</p>
                        </div>
                        <div className="text-3xl bg-yellow-100 p-3 rounded-full text-yellow-600">üè´</div>
                    </div>
                </div>

                {/* Secci√≥n Principal de Gr√°ficas */}
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    {/* Top Cursos */}
                    <div className="lg:col-span-1">
                        <ChartBox 
                            id="topCursos"
                            type="bar" 
                            title="üìö Cursos M√°s Demandados" 
                            data={Object.fromEntries(statsData.topCursos.slice(0, 10))} 
                            horizontal={true}
                            minHeight={getChartHeight(10)}
                        />
                    </div>
                    
                    {/* Top Departamentos */}
                    <div className="lg:col-span-1">
                        <ChartBox 
                            id="topDeptos"
                            type="bar" 
                            title="üè¢ Participaci√≥n por Departamento" 
                            data={Object.fromEntries(statsData.topDepartamentos)} 
                            shortenLabels={true}
                            horizontal={true}
                            minHeight={getChartHeight(statsData.topDepartamentos.length)}
                        />
                    </div>
                </div>

                {/* Secci√≥n Secundaria */}
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
                    <div className="md:col-span-1">
                        <ChartBox 
                            id="genero" 
                            type="doughnut" 
                            title="üë• Distribuci√≥n por G√©nero" 
                            data={statsData.distribucionGenero}
                            customColors={['#36A2EB', '#FF6384']} // Azul y Rosa
                        />
                    </div>
                    <div className="md:col-span-1">
                        <ChartBox 
                            id="tipo" 
                            type="pie" 
                            title="üìã Tipo de Curso" 
                            data={statsData.distribucionTipo}
                            customColors={['#10b981', '#f59e0b']} // Esmeralda y √Åmbar
                        />
                    </div>
                    <div className="md:col-span-1">
                        <ChartBox id="frecuencia" type="bar" title="üìà Cursos por Docente" data={statsData.frecuenciaParticipacion} />
                    </div>
                </div>

                {/* Evoluci√≥n Hist√≥rica */}
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <ChartBox 
                        id="historico"
                        type="bar" 
                        title="üìÖ Cursos Ofertados (Periodos vs Total Anual)" 
                        data={generateCourseEvolutionData()} 
                        isHistory={true}
                    />
                    <ChartBox 
                        id="docentesYear"
                        type="bar" 
                        title="üë®‚Äçüè´ Total Docentes por A√±o" 
                        data={generateTeacherEvolutionData()} 
                        isHistory={true}
                    />
                </div>
            </div>
        );
    };
